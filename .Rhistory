exp.pca=prcomp(t(exp),scale=T)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = T, frame.type="norm")
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = T, frame.type="norm")
autoplot(exp.pca, data = metadata, colour = 'gender',frame = F)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F,shape="gender", label = TRUE, label.size = 2)
summary(exp.pca)
unclass(exp.pca)
View (exp.pca$x)
exp.pca$x
mycolors= rep("lightgreen",dim(metadata)[1])
mycolors[which(metadata$sample.type=="PD")]="red"
plot3d(exp.pca$loadings[,1:3], pch=20 )
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
mycolors= rep("lightgreen",dim(metadata)[1])
mycolors[which(metadata$sample.type=="PD")]="red"
plot3d(exp.pca$loadings[,1:3], pch=20 )
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
exp.pca <- princomp(exp,cor=T,scores = TRUE)
names(exp.pca)
plot(exp.pca$loadings[,1],exp.pca$loadings[,2] )
View(exp.pca$loadings[,])
mycolors= rep("lightgreen",dim(metadata)[1])
mycolors[which(metadata$sample.type=="PD")]="navy"
plot3d(exp.pca$loadings[,1:3], pch=20 )
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
### PCA
## https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_pca.html
exp.pca=prcomp(t(exp),scale=T)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = T, frame.type="norm")
autoplot(exp.pca, data = metadata, colour = 'gender',frame = F)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F,shape="gender", label = TRUE, label.size = 2)
summary(exp.pca)
unclass(exp.pca)
View (exp.pca$x)
exp.pca$x
mycolors= rep("lightgreen",dim(metadata)[1])
mycolors[which(metadata$sample.type=="PD")]="red"
plot3d(exp.pca$loadings[,1:3], pch=20 )
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
### PCA
## https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_pca.html
exp.pca=prcomp(t(exp),scale=T)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = T, frame.type="norm")
autoplot(exp.pca, data = metadata, colour = 'gender',frame = F)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F,shape="gender", label = TRUE, label.size = 2)
summary(exp.pca)
unclass(exp.pca)
View (exp.pca$x)
exp.pca$x
mycolors= rep("lightgreen",dim(metadata)[1])
mycolors[which(metadata$sample.type=="PD")]="red"
plot3d(exp.pca$loadings[,1:3], pch=20 )
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
library(rgl)
library("scatterplot3d")
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
s3d <- scatterplot3d(exp.pca$loadings[1:9,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
s3d <- scatterplot3d(exp.pca$loadings[1:9,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
plot3d(exp.pca$loadings[,1:3], pch=20 )
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors, size=1)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue",size=1)
s3d <- scatterplot3d(exp.pca$x[,1:3], pch=".",col.axis="blue", col.grid="lightblue",type = p)
s3d <- scatterplot3d(exp.pca$x[,1:3], pch=".",col.axis="blue", col.grid="lightblue",type = P)
s3d <- scatterplot3d(exp.pca$x[,1:3], pch=".",col.axis="blue", col.grid="lightblue")
s3d$points3d(exp.pca$x[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$x[10:19,1:3], pch="o",col="red", cex=1)
exp.pca <- princomp(exp,cor=T,scores = TRUE)
names(exp.pca)
plot(exp.pca$loadings[,1],exp.pca$loadings[,2] )
mycolors= rep("lightgreen",dim(metadata)[1])
mycolors[which(metadata$sample.type=="PD")]="navy"
plot3d(exp.pca$loadings[,1:3], pch=20 )
plot3d(exp.pca$loadings[,1:3], pch=20 ,col=mycolors, size=1)
plot3d(exp.pca$loadings[,1:3], type="s",radius="0.015" ,col=mycolors)
s3d <- scatterplot3d(exp.pca$loadings[,1:3], pch=".",col.axis="blue", col.grid="lightblue",size=1)
s3d$points3d(exp.pca$loadings[1:9,1:3], pch="o",col="lightgreen", cex=1)
s3d$points3d(exp.pca$loadings[10:19,1:3], pch="o",col="navy", cex=1)
sds=rowSds(exp)
exp.sds=as.data.frame(cbind(exp,sds))
exp.sds.sorted=exp.sds[order(exp.sds$sds, decreasing = T),]
top100genes=rownames(exp.sds.sorted)[1:100]
exp.100=exp[top100genes, ]
Heatmap(exp.100)
scaled_mat = t(scale(t(exp.100)))
Heatmap(scaled_mat)
Heatmap(exp.100)
Heatmap(exp.100)
scaled_mat = t(scale(t(exp.100)))
Heatmap(scaled_mat)
col_fun = colorRamp2(c(min(exp.100, na.rm=T), mean(exp.100, na.rm=T), max(exp.100, na.rm=T) ), c("black", "white", "red"))
#col_fun(seq(-3, 3))
Heatmap(exp.100,col=col_fun)
col_fun = colorRamp2(c(min(scaled_mat, na.rm=T), mean(scaled_mat, na.rm=T), max(scaled_mat, na.rm=T) ), c("navy", "white", "pink"))
#col_fun(seq(-3, 3))
Heatmap(scaled_mat,col=col_fun)
#col_fun(seq(-3, 3))
Heatmap(scaled_mat,col=col_fun)
column_ha = HeatmapAnnotation(Sample.type= metadata$sample.type, Age = metadata$age,Sex = metadata$gender)
Heatmap(scaled_mat, name = "Exp", top_annotation = column_ha)
#col_fun(seq(-3, 3))
Heatmap(scaled_mat,col=col_fun)
column_ha = HeatmapAnnotation(Sample.type= metadata$sample.type, Age = metadata$age,Sex = metadata$gender)
Heatmap(scaled_mat, name = "Exp", top_annotation = column_ha)
Heatmap(scaled_mat, name = "Exp", top_annotation = column_ha)
Heatmap(scaled_mat, name = "Exp", top_annotation = column_ha, row_names_gp = gpar(fontsize = 5), column_names_gp = gpar(fontsize = 6))
heatmap(exp)
Heatmap(exp)
Heatmap(scaled_mat)
################  get the most variable genes  ###############
# also we can get it from varience (rowvar())
var=rowVars(exp)
variance=apply(exp,1,var)
help()
help(update)
update?
C
update(R)
updateR()
q()
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
### Library LOading ####
library(readxl)
library(readr)
library(ggfortify)
detach("package:ggplot2", unload = TRUE)
library(ggplot2)
library(ggfortify)
library(matrixStats)
library(ComplexHeatmap)
detach("package:grid", unload = TRUE)
library(grid, lib.loc = "C:/Program Files/R/R-4.4.0/library")
library(ComplexHeatmap)
library(genefilter)
library(multtest)
library(Biobase)
library(affy)
library(affyPLM)
detach("package:gcrma", unload = TRUE)
library(gcrma)
detach("package:preprocessCore", unload = TRUE)
library(preprocessCore)
library(affyPLM)
#library(hgu133a.db)
library(hgu133plus2.db)
detach("package:AnnotationDbi", unload = TRUE)
library(AnnotationDbi)
library(hgu133a.db)
library(cowplot)
library(reactome.db)
detach("package:stats4", unload = TRUE)
library(stats4, lib.loc = "C:/Program Files/R/R-4.4.0/library")
detach("package:IRanges", unload = TRUE)
library(IRanges)
library(BiocManager)
detach("package:S4Vectors", unload = TRUE)
library(S4Vectors)
library(MatrixGenerics)
library(affyPLM)
#library(hgu133a.db)
library(hgu133plus2.db)
#### Loading Cel files
celFileDirectory= "GSE7476"
cels= list.files (celFileDirectory, pattern = "CEL")
cels
#### Loading Cel files
celFilesDirectory= "GSE7476"
cels= list.files (celFilesDirectory, pattern = "CEL")
getpwd()
getwd()
#### Loading Cel files
celFilesDirectory= "GSE7476"
cels= list.files (celFilesDirectory, pattern = "CEL")
getwd()
setwd("~/MODA/GSE7476")
getwd()
#### Loading Cel files
celFilesDirectory= "GSE7476"
cels= list.files (celFilesDirectory, pattern = "CEL")
cels
tempdir()
# [1] "C:\Users\XYZ~1\AppData\Local\Temp\Rtmp86bEoJ\Rtxt32dcef24de2"
dir.create(tempdir())
#### Loading Cel files
celFilesDirectory= "GSE7476"
cels= list.files (celFilesDirectory, pattern = "CEL")
list.file?
?list.file
getwd()
cels= list.files ("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476", pattern = "CEL")
cels
#### Loading Cel files
celFilesDirectory= "GSE7476"
cels= list.files ("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476", pattern = "CEL")
affyData=ReadAffy(celfile.path = celFilesDirectory)
#### Loading Cel files
celFilesDirectory= "C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476"
affyData=ReadAffy(celfile.path = celFilesDirectory)
affyData
##################Data exploration#########################################
class(affyData)
sampleNames(affyData)
featureNames(affyData)
head(featureNames(affyData))
tail(featureNames(affyData))
annotation(affyData)
dim(affyData)
#See how the RAW expression look like without processing : notice the large value
head(exprs(affyData))
head(Biobase::exprs(affyData))
view(Biobase::exprs(affyData))
View(Biobase::exprs(affyData))
exp.raw=Biobase::exprs(affyData)
View(exp.raw)
# 1.histogram
hist(affyData,main="Histogram of affy data")
col=seq(1:length(sampleNames(affyData)))
cols=seq(1:length(sampleNames(affyData)))
legend("topright", sampleNames(affyData), col=cols,lty=1,lwd=3,cex = 0.3,ncol = 2)
boxplot(affyData,main="Boxplot",col=cols)
####################################################################################
#data pre-processing in one step by eset
#threestep(background correction, normalization, summarization)
eset = threestep(affyData,
background.method = "IdealMM",
normalize.method = "quantile",
summary.method = "average.log")
eset2 = expresso(affyData, bgcorrect.method = "rma",
normalize.method = "constant",
pmcorrect.method = "pmonly",
summary.method = "avgdiff")
View(exprs(eset))
View(exprs(eset2))
range(expr(eset))
range(exprs(eset))
range(exprs(eset2))
hist(eset, main = "Histogram affyData")
boxplot(eset,main = "Box plot GSE7476",col=seq(1:23))
data=exprs(eset)
View(data)
data=cbind(probe_id=row.names(data),data)
colnames(data)
### mapping probe_id into gene symbol
ls("package:hgu133plus2.db")
hgu133plus2()
mapper = hgu133plus2SYMBOL
mapper
View(mapper)
map.df = as.data.frame(mapper)
head(map.df)
# merge the two data frames to have the symbole annotation in the data object
data2=merge(data,map.df,by=probe_id,all.x=T)
head(data2)
View(map.df)
# merge the two data frames to have the symbole annotation in the data object
data2=merge(data,map.df,by=probe_id,all.x=T)
# merge the two data frames to have the symbole annotation in the data object
data2=merge(data,map.df,by="probe_id",all.x=T)
head(data2)
# drop the probe id column cause we don't need it again
data2=data2[ ,-1]
# remove nulls from data
data2=data2[! is.na(data2$symbol)]
# remove nulls from data
data2=data2[! is.na(data2$symbol),]
# check duplication of the gene symbols
x=duplicated(data2$symbol)
sum(x)
# if yes, you have to aggregate these duplicated genes
exp.data=data2[-dim(data2)[2]]
exp.data=apply(exp.data,2,as.numeric)
## remove duplication
exp.data.agg=aggregate(exp.data,by=list(data2$symbol),FUN=mean)
names(exp.data.agg)
row.names(exp.data.agg)=exp.data.agg$Group.1
row.names(exp.data.agg)=exp.data.agg$Group.1
exp.data.agg=exp.data.agg[-1]
names(exp.data.agg)=unlist(sapply(strsplit(names(exp.data.agg),"\\."),c)[1,])
# read the phenotable file
phenotable = read_excel("GSE7476/phenotable.csv")
# read the phenotable file
phenotable = read_excel("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476/phenotable.csv")
# read the phenotable file
phenotable = read.csv("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476/phenotable.csv")
View(phenotable)
phenotable$sample.type=unlist(sapply(strsplit(phenotable$sample.type, "_"),c)[2])
# save the final object in a RDATA object
exp=exp.data.agg
save(exp,phenotable, file= "GSE7476,RDATA")
load("~/MODA/GSE7476/.RData")
save(exp,phenotable, file= "GSE7476.RDATA")
load("~/MODA/GSE7476/.RData")
save(exp,phenotable, file= "GSE7476.RData")
# read the phenotable file
phenotable = read.csv("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476/phenotable.csv")
phenotable$sample.type=unlist(sapply(strsplit(phenotable$sample.type, "_"),c)[2])
# save the final object in a RDATA object
exp=exp.data.agg
save(exp,phenotable, file= "GSE7476.RData")
#### Loading Cel files
celFilesDirectory= "C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476"
cels= list.files ("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476", pattern = "CEL")
cels
affyData=ReadAffy(celfile.path = celFilesDirectory)
affyData
##################Data exploration#########################################
class(affyData)
sampleNames(affyData)
featureNames(affyData)
head(featureNames(affyData))
tail(featureNames(affyData))
annotation(affyData)
dim(affyData)
#See how the RAW expression look like without processing : notice the large value
head(exprs(affyData))
head(Biobase::exprs(affyData))
View(Biobase::exprs(affyData))
Biobase::exprs(affyData)[1:3,1:5]
exp.raw=Biobase::exprs(affyData)
## pca on exp.raw ##
exp.pca=prcomp(t(exp.raw),scale=T)
autoplot(exp.pca, data = metadata, colour = 'sample.type',frame = F)
autoplot(exp.pca, data = phenotable, colour = 'sample.type',frame = F)
autoplot(exp.pca, data = phenotable, colour = 'sample.type',frame = T, frame.type="norm")
autoplot(exp.pca, data = phenotable, colour = 'gender',frame = F)
# 1.histogram
hist(affyData,main="Histogram of affy data")
cols=seq(1:length(sampleNames(affyData)))
legend("topright", sampleNames(affyData), col=cols,lty=1,lwd=3,cex = 0.3,ncol = 2)
boxplot(affyData,main="Boxplot",col=cols)
####################################################################################
#data pre-processing in one step by eset
#threestep(background correction, normalization, summarization)
eset = threestep(affyData,
background.method = "IdealMM",
normalize.method = "quantile",
summary.method = "average.log")
#another method for pre_processing
eset2 = expresso(affyData, bgcorrect.method = "rma",
normalize.method = "constant",
pmcorrect.method = "pmonly",
summary.method = "avgdiff")
hist(eset, main = "Histogram affyData")
boxplot(eset,main = "Box plot GSE7476",col=seq(1:23))
data=exprs(eset)
View(data)
data=cbind(probe_id=row.names(data),data)
colnames(data)
### mapping probe_id into gene symbol
ls("package:hgu133plus2.db")
hgu133plus2() #give the no. of known probe
mapper = hgu133plus2SYMBOL
mapper
map.df = as.data.frame(mapper)
head(map.df)
# merge the two data frames to have the symbole annotation in the data object
data2=merge(data,map.df,by="probe_id",all.x=T)
head(data2)
# drop the probe id column cause we don't need it again
data2=data2[ ,-1]
# remove nulls from data
data2=data2[! is.na(data2$symbol), ]
# check duplication of the gene symbols
x=duplicated(data2$symbol)
sum(x)
# if yes, you have to aggregate these duplicated genes
exp.data=data2[-dim(data2)[2]]
exp.data=apply(exp.data,2,as.numeric)
## remove duplication
exp.data.agg=aggregate(exp.data,by=list(data2$symbol),FUN=mean)
## remove duplication
exp.data.agg=aggregate(exp.data,by=list(data2$symbol),FUN=mean)
names(exp.data.agg)
row.names(exp.data.agg)=exp.data.agg$Group.1
exp.data.agg=exp.data.agg[-1]
names(exp.data.agg)=unlist(sapply(strsplit(names(exp.data.agg),"\\."),c)[1,])
# read the phenotable file
phenotable = read.csv("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476/phenotable.csv")
# read the phenotable file
phenotable = read.csv("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476/phenotable.csv")
phenotable$sample.type=unlist(sapply(strsplit(phenotable$sample.type, "_"),c)[2])
# save the final object in a RDATA object
exp=exp.data.agg
### Library LOading ####
library(readxl)
library(readr)
library(ggfortify)
library(matrixStats)
library(ComplexHeatmap)
library(genefilter)
library(multtest)
library(Biobase)
library(affy)
library(affyPLM)
#library(hgu133a.db)
library(hgu133plus2.db)
tempdir()
# [1] "C:\Users\XYZ~1\AppData\Local\Temp\Rtmp86bEoJ\Rtxt32dcef24de2"
dir.create(tempdir())
#### Loading Cel files
celFilesDirectory= "C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476"
cels= list.files ("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476", pattern = "CEL")
cels
affyData=ReadAffy(celfile.path = celFilesDirectory)
# 1.histogram
hist(affyData,main="Histogram of affy data")
legend("topright", sampleNames(affyData), col=cols,lty=1,lwd=3,cex = 0.3,ncol = 2)
boxplot(affyData,main="Boxplot",col=cols)
####################################################################################
#data pre-processing in one step by eset
#threestep(background correction, normalization, summarization)
eset = threestep(affyData,
background.method = "IdealMM",
normalize.method = "quantile",
summary.method = "average.log")
#another method for pre_processing
eset2 = expresso(affyData, bgcorrect.method = "rma",
normalize.method = "constant",
pmcorrect.method = "pmonly",
summary.method = "avgdiff")
map.df = as.data.frame(mapper)
head(map.df)
# merge the two data frames to have the symbole annotation in the data object
data2=merge(data,map.df,by="probe_id",all.x=T)
head(data2)
# drop the probe id column cause we don't need it again
data2=data2[ ,-1]
# remove nulls from data
data2=data2[! is.na(data2$symbol), ]
# check duplication of the gene symbols
x=duplicated(data2$symbol)
sum(x)
# if yes, you have to aggregate these duplicated genes
exp.data=data2[-dim(data2)[2]]
exp.data=apply(exp.data,2,as.numeric)
## remove duplication
exp.data.agg=aggregate(exp.data,by=list(data2$symbol),FUN=mean)
names(exp.data.agg)
row.names(exp.data.agg)=exp.data.agg$Group.1
exp.data.agg=exp.data.agg[-1]
names(exp.data.agg)=unlist(sapply(strsplit(names(exp.data.agg),"\\."),c)[1,])
# read the phenotable file
phenotable = read.csv("C:/Users/Radwa.DESKTOP-77IVMB8/Documents/MODA/GSE7476/phenotable.csv")
phenotable$sample.type=unlist(sapply(strsplit(phenotable$sample.type, "_"),c)[2])
# save the final object in a RDATA object
exp=exp.data.agg
save(exp,phenotable, file= "GSE7476.RData")
load("~/MODA/GSE7476/GSE7476.RData")
save(exp,phenotable, file= "GSE7476.RData")
